var data = '[{"War":"Philippine insurrection","Start":"1899","End":"1902","Deaths":"70,000","Continent":"Asia"},'+
'{"War":"Boer war","Start":"1899","End":"1902","Deaths":"50,500","Continent":"Africa"},'+
'{"War":"The War of a Thousand Days","Start":"1899","End":"1903","Deaths":"100,000","Continent":"South America"},'+
'{"War":"The Boxer Revolt","Start":"1900","End":"1900","Deaths":"13,000","Continent":"Asia"},'+
'{"War":"Russo-Japanese war","Start":"1904","End":"1905","Deaths":"130,000","Continent":"Asia"},'+
'{"War":"Southwest African Revolt","Start":"1904","End":"1905","Deaths":"78,000","Continent":"Africa"},{"War":"Maji Maji revolt","Start":"1905","End":"1906","Deaths":"140,000","Continent":"Africa"},{"War":"Second Rif War","Start":"1909","End":"1910","Deaths":"12,000","Continent":"Africa"},{"War":"Mexican Revolution","Start":"1910","End":"1920","Deaths":"250,000","Continent":"North America"},{"War":"Italo-Turkish War","Start":"1911","End":"1912","Deaths":"20,000","Continent":"Africa"},{"War":"1st Balkan War","Start":"1912","End":"1913","Deaths":"82,000","Continent":"Europe"},{"War":"2nd Balkan War","Start":"1913","End":"1913","Deaths":"61,000","Continent":"Europe"},{"War":"World War I","Start":"1914","End":"1918","Deaths":"14,000,000","Continent":"Multiple"},{"War":"Armenian Genocide","Start":"1915","End":"1918","Deaths":"1,000,000","Continent":"Europe-Asia"},{"War":"Russian Revolution","Start":"1917","End":"1922","Deaths":"2,000,000","Continent":"Europe-Asia"},{"War":"Finnish Civil War","Start":"1918","End":"1918","Deaths":"20,000","Continent":"Europe"},{"War":"Hungarianâ€“Romanian War of 1919","Start":"1919","End":"1919","Deaths":"11,000","Continent":"Europe"},{"War":"Polish-Soviet War","Start":"1919","End":"1920","Deaths":"50,000","Continent":"Europe"},{"War":"Armenian Massacre Aftermath","Start":"1919","End":"1923","Deaths":"432,500","Continent":"Europe-Asia"},{"War":"Turkish War of Independence","Start":"1919","End":"1921","Deaths":"40,000","Continent":"Europe-Asia"},{"War":"Greco Turkish War","Start":"1919","End":"1922","Deaths":"70,000","Continent":"Europe-Asia"},{"War":"Third Rif War","Start":"1920","End":"1926","Deaths":"40,000","Continent":"Africa"},{"War":"Sansui (Senussi), Libya vs Italy","Start":"1920","End":"1932","Deaths":"96,000","Continent":"Africa"},{"War":"India vs UK rebellion","Start":"1921","End":"1922","Deaths":"11,000","Continent":"Asia"},{"War":"Northern Expedition","Start":"1926","End":"1928","Deaths":"10,500","Continent":"Asia"},{"War":"French Equatorial Africa","Start":"1927","End":"1931","Deaths":"55,000","Continent":"Africa"},{"War":"Kuomintang vs islamic rebels","Start":"1928","End":"1928","Deaths":"200,000","Continent":"Asia"},{"War":"Kuomintang vs warlords","Start":"1929","End":"1930","Deaths":"75,000","Continent":"Asia"},{"War":"Communists vs Koumintang","Start":"1930","End":"1935","Deaths":"350,000","Continent":"Asia"},{"War":"Manchurian War","Start":"1931","End":"1933","Deaths":"60,000","Continent":"Asia"},{"War":"Soviet vs Turkestan","Start":"1931","End":"1934","Deaths":"20,000","Continent":"Europe-Asia"},{"War":"Chaco War","Start":"1931","End":"1935","Deaths":"130,000","Continent":"South America"},{"War":"El Salvador, La Mataza","Start":"1932","End":"1932","Deaths":"20,000","Continent":"South America"},{"War":"Italo-Ethiopian War","Start":"1935","End":"1936","Deaths":"175,000","Continent":"Africa"},{"War":"India vs UK rebellion","Start":"1936","End":"1938","Deaths":"11,000","Continent":"Asia"},{"War":"Spanish Civil War","Start":"1936","End":"1939","Deaths":"780,000","Continent":"Europe"},{"War":"Sino-Japanese War","Start":"1937","End":"1941","Deaths":"1,000,000","Continent":"Asia"},{"War":"The battle of Khalkhin Gol","Start":"1939","End":"1939","Deaths":"28,000","Continent":"Asia"},{"War":"The Winter War in Finland","Start":"1939","End":"1940","Deaths":"90,000","Continent":"Europe"},{"War":"World War II","Start":"1939","End":"1945","Deaths":"49,800,000","Continent":"Multiple"},{"War":"Greece Civil War","Start":"1944","End":"1949","Deaths":"66,000","Continent":"Europe"},{"War":"Indonesian Independence","Start":"1945","End":"1946","Deaths":"15,000","Continent":"Asia"},{"War":"Chinese Civil War","Start":"1945","End":"1950","Deaths":"1,000,000","Continent":"Asia"},{"War":"First Indochina War Comm. vs France","Start":"1945","End":"1954","Deaths":"606,000","Continent":"Asia"},{"War":"La Violencia","Start":"1946","End":"1962","Deaths":"250,000","Continent":"South America"},{"War":"Indian civil war","Start":"1947","End":"1948","Deaths":"500,000","Continent":"Asia"},{"War":"Madagascar Rebellion","Start":"1947","End":"1948","Deaths":"11,000","Continent":"Africa"},{"War":"Malayan Civil War","Start":"1948","End":"1957","Deaths":"13,000","Continent":"Asia"},{"War":"Israel vs Palestine","Start":"1948","End":"2009","Deaths":"14,500","Continent":"Asia"},{"War":"Korean War","Start":"1950","End":"1953","Deaths":"2,690,000","Continent":"Asia"},{"War":"Kenya, Mau-Mau vs UK","Start":"1952","End":"1956","Deaths":"13,000","Continent":"Africa"},{"War":"Algerian War of Independece","Start":"1954","End":"1962","Deaths":"223,744","Continent":"Africa"},{"War":"Cameroon War of Independence","Start":"1955","End":"1960","Deaths":"32,000","Continent":"Africa"},{"War":"Tibetan Rebellion","Start":"1956","End":"1959","Deaths":"100,000","Continent":"Asia"},{"War":"Indonesian dissidents vs Govt","Start":"1956","End":"1960","Deaths":"30,000","Continent":"Asia"},{"War":"Iraq vs Kurdistan","Start":"1960","End":"1963","Deaths":"105,000","Continent":"Asia"},{"War":"Congo Govt vs Katanga Rebels","Start":"1960","End":"1965","Deaths":"100,000","Continent":"Africa"},{"War":"Vietnam civil war","Start":"1960","End":"1965","Deaths":"300,000","Continent":"Asia"},{"War":"Angolan War of Independence","Start":"1961","End":"1975","Deaths":"81,500","Continent":"Africa"},{"War":"Vietnam War","Start":"1961","End":"1975","Deaths":"1,400,000","Continent":"Asia"},{"War":"North Yemen Civil War","Start":"1962","End":"1969","Deaths":"100,000","Continent":"Asia"},{"War":"Guinea Bissau War of Independence","Start":"1962","End":"1974","Deaths":"15,000","Continent":"Africa"},{"War":"Rwanda Civil War","Start":"1963","End":"1964","Deaths":"30,000","Continent":"Africa"},{"War":"Sudan Govt vs Guerilla","Start":"1963","End":"1972","Deaths":"500,000","Continent":"Africa"},{"War":"Laos Govt vs Vietnamese Guerilla","Start":"1963","End":"1973","Deaths":"15,000","Continent":"Asia"},{"War":"Mozambique War of Independence","Start":"1964","End":"1975","Deaths":"45,000","Continent":"Africa"},{"War":"Guatemala military coup","Start":"1966","End":"1972","Deaths":"58,000","Continent":"South America"},{"War":"Namibia vs South Africa","Start":"1966","End":"1988","Deaths":"12,800","Continent":"Africa"},{"War":"The Six Day War","Start":"1967","End":"1967","Deaths":"19,000","Continent":"Asia"},{"War":"China Culture Revolution","Start":"1967","End":"1968","Deaths":"50,000","Continent":"Asia"},{"War":"Nigerian Civil War","Start":"1967","End":"1970","Deaths":"1,500,000","Continent":"Africa"},{"War":"Philippines Guerrilla CPP vs Govt","Start":"1969","End":"2003","Deaths":"35,000","Continent":"Asia"},{"War":"Cambodian Civil War","Start":"1970","End":"1975","Deaths":"450,000","Continent":"Asia"},{"War":"Bangladesh War","Start":"1971","End":"1971","Deaths":"1,500,000","Continent":"Asia"},{"War":"Burundi, Hutu Revolt","Start":"1972","End":"1972","Deaths":"150,000","Continent":"Africa"},{"War":"Rhodesia Guerillas vs Govt","Start":"1972","End":"1979","Deaths":"21,000","Continent":"Africa"},{"War":"Philippines Govt vs Mindanao Guerilla","Start":"1972","End":"2003","Deaths":"40,000","Continent":"Asia"},{"War":"Yom Kippur War","Start":"1973","End":"1973","Deaths":"16,100","Continent":"Asia"},{"War":"Ethiopia vs Eritrea","Start":"1974","End":"1991","Deaths":"373,000","Continent":"Africa"},{"War":"Cambodian holocaust","Start":"1975","End":"1979","Deaths":"1,600,000","Continent":"Asia"},{"War":"Lebanese Civil War","Start":"1975","End":"1990","Deaths":"170,000","Continent":"Asia"},{"War":"Angolan Gvt vs UNITA Guerilla","Start":"1975","End":"2000","Deaths":"120,000","Continent":"Africa"},{"War":"Argentinas Dirty War","Start":"1976","End":"1983","Deaths":"20,000","Continent":"South America"},{"War":"Ethiopia vs Somali Rebels","Start":"1976","End":"1983","Deaths":"36,000","Continent":"Africa"},{"War":"East Timorese Guerilla vs Indonesioan Govt","Start":"1976","End":"1999","Deaths":"210,000","Continent":"Asia"},{"War":"Ethiopia vs Somalia","Start":"1977","End":"1978","Deaths":"15,000","Continent":"Africa"},{"War":"Nicaraguan Gvt vs Sandinistas","Start":"1978","End":"1979","Deaths":"30,000","Continent":"South America"},{"War":"Guatemalan Govt vs Guerilla","Start":"1978","End":"1984","Deaths":"73,000","Continent":"South America"},{"War":"Tigray rebels TPLF vs Ethiopian Gvt","Start":"1978","End":"1991","Deaths":"15,000","Continent":"Africa"},{"War":"Afghanistan Civil War","Start":"1978","End":"2000","Deaths":"1,400,000","Continent":"Asia"},{"War":"Sinovietnamese War","Start":"1979","End":"1979","Deaths":"31,000","Continent":"Asia"},{"War":"El Salvador Gvt vs FMLN Guerrillas","Start":"1979","End":"1992","Deaths":"75,000","Continent":"South America"},{"War":"Mozambique Govt vs Guerilla","Start":"1979","End":"1992","Deaths":"200,000","Continent":"Africa"},{"War":"Cambodian Govt vs Khmer Rouge","Start":"1979","End":"1998","Deaths":"125,000","Continent":"Asia"},{"War":"Uganda Civil War","Start":"1980","End":"1988","Deaths":"105,000","Continent":"Africa"},{"War":"Iran vs Iraq","Start":"1980","End":"1988","Deaths":"1,000,000","Continent":"Asia"},{"War":"Peruvian Gvt vs Sendero Luminoso and MRTA","Start":"1980","End":"1999","Deaths":"50,000","Continent":"South America"},{"War":"Iran vs Muhajedin e-Khalq","Start":"1981","End":"1982","Deaths":"14,000","Continent":"Asia"},{"War":"Chad Civil War","Start":"1982","End":"2002","Deaths":"37,500","Continent":"Africa"},{"War":"Nicaragua Govt vs Contras","Start":"1982","End":"1990","Deaths":"43,000","Continent":"South America"},{"War":"Guatemalan Govt vs Guerilla","Start":"1982","End":"1995","Deaths":"46,300","Continent":"South America"},{"War":"Somali Civil War","Start":"1982","End":"2009","Deaths":"85,000","Continent":"Africa"},{"War":"Sudan Govt vs Rebels","Start":"1983","End":"2003","Deaths":"600,000","Continent":"Asia"},{"War":"Sri Lankan Civil War","Start":"1983","End":"2009","Deaths":"45,000","Continent":"Asia"},{"War":"Colombia Govt vs Guerillas Farc and ELN","Start":"1984","End":"2000","Deaths":"22,000","Continent":"South America"},{"War":"Turkey Gvt vs Kurdistan Guerilla PPK","Start":"1984","End":"2004","Deaths":"30,000","Continent":"Europe-Asia"},{"War":"Indian Govt vs Punjab","Start":"1985","End":"2000","Deaths":"19,000","Continent":"Asia"},{"War":"S Yemen Coup","Start":"1986","End":"1986","Deaths":"12,000","Continent":"Asia"},{"War":"Sri Lanka Govt vs S Nationalists","Start":"1987","End":"1989","Deaths":"30,000","Continent":"Asia"},{"War":"Ugandan Civil War","Start":"1987","End":"2005","Deaths":"100,000","Continent":"Africa"},{"War":"Burundi, Tutsi Gvt vs Hutu","Start":"1988","End":"1988","Deaths":"20,000","Continent":"Africa"},{"War":"South Africa, Political Violence","Start":"1989","End":"1993","Deaths":"20,000","Continent":"Africa"},{"War":"Liberia Civil War","Start":"1989","End":"1997","Deaths":"150,000","Continent":"Africa"},{"War":"India vs Pakistan, Kashmir Dispute","Start":"1989","End":"2009","Deaths":"25,000","Continent":"Asia"},{"War":"First Gulf War","Start":"1990","End":"1991","Deaths":"57,000","Continent":"Asia"},{"War":"Rwanda, Hutus vs Tutsis","Start":"1990","End":"1994","Deaths":"800,000","Continent":"Africa"},{"War":"Azerbajan vs Soviet Union","Start":"1990","End":"1994","Deaths":"20,000","Continent":"Europe-Asia"},{"War":"Algeria Govt vs Islamic rebels, GIA","Start":"1990","End":"2005","Deaths":"100,000","Continent":"Africa"},{"War":"Somalia Civil War","Start":"1990","End":"2010","Deaths":"30,000","Continent":"Africa"},{"War":"Iraq vs Iran based rebels","Start":"1991","End":"2000","Deaths":"180,000","Continent":"Asia"},{"War":"Iran vs Muhajedin","Start":"1991","End":"2000","Deaths":"17,000","Continent":"Asia"},{"War":"Burundi Tutsi Govt vs Hutu Rebels","Start":"1991","End":"2005","Deaths":"150,000","Continent":"Africa"},{"War":"Bosnian Govt vs Serbian Insurgents","Start":"1992","End":"1995","Deaths":"175,000","Continent":"Europe"},{"War":"Tajikistan Govt vs Opposition","Start":"1992","End":"1998","Deaths":"30,000","Continent":"Asia"},{"War":"Sierra Leone Govt vs Rebels","Start":"1994","End":"2000","Deaths":"75,000","Continent":"Africa"},{"War":"Russia vs Chechnyan Secessionists","Start":"1994","End":"2006","Deaths":"65,000","Continent":"Europe-Asia"},{"War":"Nepal Civil War","Start":"1996","End":"2005","Deaths":"12,700","Continent":"Asia"},{"War":"Dem Rep of Congo vs Rebels","Start":"1998","End":"2009","Deaths":"3,000,000","Continent":"Africa"},{"War":"Eritrea vs Ethiopia","Start":"1998","End":"2000","Deaths":"80,000","Continent":"Africa"},{"War":"Afghanistan war","Start":"2001","End":"2009","Deaths":"35,000","Continent":"Asia"},{"War":"Iraq vs US led coalition","Start":"2003","End":"2009","Deaths":"40,000","Continent":"Asia"},{"War":"Darfur Conflict in Sudan","Start":"2003","End":"2009","Deaths":"100,000","Continent":"Africa"},{"War":"Waziristan conflict","Start":"2004","End":"2009","Deaths":"16,000","Continent":"Asia"},{"War":"Kept to those over 10k","Start":"","End":"","Deaths":"","Continent":""},{"War":"NB: Israel-Palestine refers to direct casualties, not wider effects on PLO of blockades etc","Start":"","End":"","Deaths":"","Continent":""}]';

var canvas;
var ctx;
var poppies = [];

window.onload = onLoad;


function onLoad()
{
	canvas=document.getElementById("canvas");
	ctx = canvas.getContext('2d');
	// ctx.shadowColor = "rgba( 0, 0, 0, 0.3 )";
	// ctx.shadowOffsetX = 1;
	// ctx.shadowOffsetY = 1;
	// ctx.shadowBlur = 3;

	jsonresponse = JSON.parse(data);

	createCurves(jsonresponse)

	animate();
}



function createCurves(jsonData)
{
var small =1000000;
var big = 0;

	for(var i=0; i<jsonData.length; i++)
	{
		var continent = jsonData[i].Continent.toLowerCase();
		var start = Number(jsonData[i].Start);
		var end = Number(jsonData[i].End);
		var deaths = Number(jsonData[i].Deaths.replace(/,/g , ""));

		if(continent=="" || start==NaN || end==NaN || deaths==NaN) return;

		poppies.push( new Poppy(continent,
								start,
								end,
								deaths) );
	}
}


function render()
{ 
    ctx.fillStyle = "#fff9e1";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    var i = poppies.length; 
    while(--i>0)
    {
      poppies[i].update();
    }
}







/*
function loadJSON(callback) 
{

	var xobj = new XMLHttpRequest();
	xobj.overrideMimeType("application/json");
	xobj.open('GET', 'wars_data.json', true);
	xobj.onreadystatechange = function () 
	{
		if (xobj.readyState == 4 && xobj.status == "200") 
		{

		// .open will NOT return a value but simply returns undefined in async mode so use a callback
			callback(xobj.responseText);

		}
	}
	xobj.send(null);

}
*/



